<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Menu Pizze - AL DOGE</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --gold: #d4af37;
      --dark: #0b0b0b;
      --soft: #1a1a1a;
      --text: #f5f5f5;
      --muted: #b3b3b3;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--dark);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      padding-bottom: 100px;
    }

    .logo-fixed {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 999;
      width: 60px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
      cursor: pointer;
    }

    .cart-fixed {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 999;
      background: var(--gold);
      color: black;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
      transition: transform 0.3s;
    }

    .cart-fixed:hover {
      transform: scale(1.1);
    }

    .cart-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ff4444;
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
    }

    header {
      padding: 100px 20px 40px;
      text-align: center;
      background: linear-gradient(180deg, var(--soft) 0%, var(--dark) 100%);
    }

    h1 {
      font-family: 'Playfair Display', serif;
      color: var(--gold);
      font-size: clamp(36px, 6vw, 56px);
      margin-bottom: 10px;
    }

    .subtitle {
      color: var(--muted);
      font-size: 18px;
    }

    .controls {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 20px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
    }

    .search-box {
      flex: 1;
      min-width: 250px;
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 12px 20px;
      border-radius: 25px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      background: var(--soft);
      color: var(--text);
      font-size: 16px;
    }

    .search-box input::placeholder {
      color: var(--muted);
    }

    .filter-btn {
      padding: 12px 24px;
      border-radius: 25px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      background: var(--soft);
      color: var(--text);
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s;
    }

    .filter-btn:hover,
    .filter-btn.active {
      background: var(--gold);
      color: black;
      border-color: var(--gold);
    }

    .menu-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 25px;
    }

    .pizza-card {
      background: var(--soft);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid rgba(212, 175, 55, 0.2);
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
    }

    .pizza-card:hover {
      transform: translateY(-5px);
      border-color: var(--gold);
      box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
    }

    .pizza-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .pizza-name {
      font-family: 'Playfair Display', serif;
      color: var(--gold);
      font-size: 22px;
      font-weight: 600;
      flex: 1;
    }

    .pizza-price {
      font-size: 24px;
      font-weight: 600;
      color: var(--gold);
      white-space: nowrap;
      margin-left: 10px;
    }

    .pizza-ingredients {
      color: var(--muted);
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
      flex: 1;
    }

    .pizza-allergeni {
      font-size: 12px;
      color: #ff9999;
      margin-bottom: 15px;
    }

    .pizza-actions {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: auto;
    }

    .quantity-control {
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--dark);
      border-radius: 25px;
      padding: 5px;
    }

    .qty-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: var(--gold);
      color: black;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }

    .qty-display {
      min-width: 30px;
      text-align: center;
      font-weight: 600;
    }

    .add-to-cart-btn {
      flex: 1;
      padding: 12px 20px;
      border-radius: 25px;
      border: none;
      background: var(--gold);
      color: black;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }

    .add-to-cart-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
    }

    .add-to-cart-btn:active {
      transform: scale(0.98);
    }

    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
      font-size: 18px;
    }

    @media (max-width: 768px) {
      .menu-container {
        grid-template-columns: 1fr;
      }

      .controls {
        flex-direction: column;
      }

      .filter-btn {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <!-- Logo fisso -->
  <img src="logo-al-doge.png" class="logo-fixed" onclick="window.location.href='home.html'" alt="AL DOGE">

  <!-- Carrello fisso -->
  <div class="cart-fixed" onclick="window.location.href='carrello.html'" id="cart-icon">
    üõí
    <span class="cart-badge" id="cart-badge" style="display: none;">0</span>
  </div>

  <header>
    <h1>üçï Menu Pizze</h1>
    <p class="subtitle">35 pizze tradizionali cotte al forno a legna</p>
  </header>

  <div class="controls">
    <div class="search-box">
      <input type="text" id="search-input" placeholder="üîç Cerca pizza per nome...">
    </div>
    <button class="filter-btn active" data-filter="all">Tutte</button>
    <button class="filter-btn" data-filter="classica">Classiche</button>
    <button class="filter-btn" data-filter="speciale">Speciali</button>
    <button class="filter-btn" data-filter="piccante">Piccanti</button>
  </div>

  <div class="menu-container" id="menu-container">
    <!-- Le pizze verranno caricate dinamicamente -->
  </div>

  <div class="no-results" id="no-results" style="display: none;">
    Nessuna pizza trovata con i criteri selezionati.
  </div>

  <script>
    let allPizzas = [];
    let currentFilter = 'all';
    let searchTerm = '';

    // Carica menu
    async function loadMenu() {
      try {
        const response = await fetch('menu.json');
        const data = await response.json();
        allPizzas = data.pizze;
        displayPizzas();
      } catch (error) {
        console.error('Errore caricamento menu:', error);
        document.getElementById('menu-container').innerHTML = 
          '<p style="text-align: center; color: var(--muted);">Errore nel caricamento del menu</p>';
      }
    }

    // Visualizza pizze
    function displayPizzas() {
      const container = document.getElementById('menu-container');
      const noResults = document.getElementById('no-results');
      
      let filtered = allPizzas;
      
      // Filtra per categoria
      if (currentFilter !== 'all') {
        filtered = filtered.filter(p => p.categoria === currentFilter);
      }
      
      // Filtra per ricerca
      if (searchTerm) {
        filtered = filtered.filter(p => 
          p.nome.toLowerCase().includes(searchTerm.toLowerCase()) ||
          p.ingredienti.some(ing => ing.toLowerCase().includes(searchTerm.toLowerCase()))
        );
      }
      
      if (filtered.length === 0) {
        container.innerHTML = '';
        noResults.style.display = 'block';
        return;
      }
      
      noResults.style.display = 'none';
      container.innerHTML = filtered.map(pizza => `
        <div class="pizza-card" data-pizza-id="${pizza.nome}">
          <div class="pizza-header">
            <h3 class="pizza-name">${pizza.nome}</h3>
            <div class="pizza-price">‚Ç¨${pizza.prezzo.toFixed(2)}</div>
          </div>
          <div class="pizza-ingredients">${pizza.ingredienti.join(', ')}</div>
          <div class="pizza-allergeni">‚ö†Ô∏è Allergeni: ${pizza.allergeni.join(', ')}</div>
          <div class="pizza-actions">
            <div class="quantity-control">
              <button class="qty-btn" onclick="changeQuantity('${pizza.nome}', -1)">‚àí</button>
              <span class="qty-display" id="qty-${pizza.nome.replace(/\s/g, '-')}">1</span>
              <button class="qty-btn" onclick="changeQuantity('${pizza.nome}', 1)">+</button>
            </div>
            <button class="add-to-cart-btn" onclick="addToCart('${pizza.nome}', event)">
              üõí Aggiungi
            </button>
          </div>
        </div>
      `).join('');
    }

    // Gestione quantit√†
    const quantities = {};
    
    function changeQuantity(pizzaName, delta) {
      const id = pizzaName.replace(/\s/g, '-');
      if (!quantities[pizzaName]) quantities[pizzaName] = 1;
      
      quantities[pizzaName] = Math.max(1, Math.min(99, quantities[pizzaName] + delta));
      document.getElementById(`qty-${id}`).textContent = quantities[pizzaName];
    }

    // Aggiungi al carrello
    function addToCart(pizzaName, event) {
      const pizza = allPizzas.find(p => p.nome === pizzaName);
      if (!pizza) return;
      
      const quantity = quantities[pizzaName] || 1;
      
      // Recupera carrello esistente
      let cart = JSON.parse(localStorage.getItem('aldoge_cart') || '[]');
      
      // Cerca se la pizza √® gi√† nel carrello
      const existingIndex = cart.findIndex(item => item.type === 'pizza' && item.name === pizzaName);
      
      if (existingIndex !== -1) {
        // Aggiorna quantit√†
        cart[existingIndex].quantity += quantity;
      } else {
        // Aggiungi nuovo item
        cart.push({
          type: 'pizza',
          name: pizzaName,
          price: pizza.prezzo,
          ingredients: pizza.ingredienti,
          allergeni: pizza.allergeni,
          quantity: quantity
        });
      }
      
      // Salva carrello
      localStorage.setItem('aldoge_cart', JSON.stringify(cart));
      
      // Reset quantit√†
      quantities[pizzaName] = 1;
      const id = pizzaName.replace(/\s/g, '-');
      document.getElementById(`qty-${id}`).textContent = '1';
      
      // Feedback visivo
      const btn = event ? event.target : null;
      if (btn) {
        const originalText = btn.innerHTML;
        btn.innerHTML = '‚úì Aggiunto!';
        btn.style.background = '#4CAF50';
        
        setTimeout(() => {
          btn.innerHTML = originalText;
          btn.style.background = '';
        }, 1500);
      }
      
      updateCartBadge();
    }

    // Aggiorna badge carrello
    function updateCartBadge() {
      const cart = JSON.parse(localStorage.getItem('aldoge_cart') || '[]');
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      const badge = document.getElementById('cart-badge');
      
      if (totalItems > 0) {
        badge.textContent = totalItems;
        badge.style.display = 'flex';
      } else {
        badge.style.display = 'none';
      }
    }

    // Gestione filtri
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.filter;
        displayPizzas();
      });
    });

    // Gestione ricerca
    document.getElementById('search-input').addEventListener('input', (e) => {
      searchTerm = e.target.value;
      displayPizzas();
    });

    // Inizializza
    loadMenu();
    updateCartBadge();
  </script>
</body>
</html>
